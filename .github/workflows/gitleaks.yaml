# .github/workflows/gitleaks.yaml
name: ğŸ” DevSecOps - Secret Scanner (Gitleaks)

# This workflow will run anytime code is pushed to the main branch
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  secret_scan:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code and History
        # Crucial for Gitleaks: fetch-depth: 0 ensures the entire Git history is downloaded
        # so Gitleaks can find secrets committed in the past.
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 
          
      - name: ğŸ” Run Gitleaks Scan (OSS SAST)
        uses: zricethezav/gitleaks-action@v2
        with:
          # Tells Gitleaks to use the custom YAML configuration file
          config: .gitleaks.yaml 
        # continue-on-error: true ensures the pipeline completes, even if a secret is found, 
        # so you get your data for the presentation.
        continue-on-error: true